<script type="module">
    // Import the functions you need from the SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
    import { getFirestore, collection, addDoc, query, orderBy, getDocs } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";

    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCLP3pAvW056uR9DPAjx1kdxYMerKPeOf0",
        authDomain: "cloud-chatter.firebaseapp.com",
        projectId: "cloud-chatter",
        storageBucket: "cloud-chatter.appspot.com",
        messagingSenderId: "103151989189",
        appId: "1:103151989189:web:4ccc0900b9e7e77dc4dbac"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const messageInput = document.getElementById('messageInput');
    const sendButton = document.getElementById('sendButton');
    const messagesDiv = document.getElementById('messages');

    // Function to send message
    sendButton.addEventListener('click', async () => {
        const message = messageInput.value.trim();
        if (message) {
            try {
                await addDoc(collection(db, 'nam5'), {
                    text: message,
                    timestamp: new Date()
                });
                messageInput.value = ''; // Clear input field
                loadMessages(); // Reload messages
            } catch (error) {
                console.error("Error adding message: ", error);
            }
        }
    });

    // Function to load messages
    async function loadMessages() {
        messagesDiv.innerHTML = ''; // Clear previous messages
        try {
            const q = query(collection(db, 'nam5'), orderBy('timestamp', 'desc'));
            const querySnapshot = await getDocs(q);
            querySnapshot.forEach(doc => {
                const message = doc.data();
                const messageElement = document.createElement('div');
                messageElement.textContent = message.text;
                messagesDiv.prepend(messageElement); // Add message to the top
            });
        } catch (error) {
            console.error("Error loading messages: ", error);
        }
    }

    // Load messages on page load
    loadMessages();
</script>